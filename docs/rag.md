# Архитектура RAG

### Этапы работы c Retrieval-Augmented Generation (RAG):

1) Извлечение релевантных документов *(Ретривер на базе FAISS-индекса возвращает релевантные документы)*
2) Обогащение запросов через LLM
3) Фильтрация и ранжирование результатов 

## Обработка запросов:
1) Автоопределение жанра *(Используется словарь жанров для автоопределения жанра по запросу)*
> Пример определения жанров: запрос "Я хочу почитать какую-нибудь забавную лавстори" определяет жанр *"Роман"*
2) Обогащение запросов *(Запрос передается через LLM (GigaChat-Pro), чтобы уточнить контекст и добавить релевантные ключевые слова)*
> Пример обогащения запроса:
> 
> Исходный запрос:  Я хочу почитать какую-нибудь забавную лавстори <br>
> Определённый жанр: Роман  <br>
> Обогащённый запрос: <br>
> Я хочу почитать какую-нибудь забавную лавстори. Ключевые слова:  <br>
> 1. Забавная лавстори  <br>
> 2. Легкая комедия  <br>
> 3. Романтическая комедия  <br>
> 4. Любовь и юмор  <br>
> 5. Смешная история любви  <br>
> 6. Романтика с элементами комедии  <br>
> 7. Веселая романтическая книга
4) Фильтрация и ранжирование результатов *(Результаты ранжируются с помощью косинусного сходства (с использованием Sentence-BERT). Если жанр определен, фильтрация результатов происходит с учетом жанра)*
